{% extends 'base.html.twig' %}

{% block title %}Hello {{ controller_name }}!{% endblock %}

{% set bodyClasses = 'dashboard-layout' %}

{% block body %}
    {# Side menu drawer #}
    <aside class="mdc-drawer mdc-drawer--modal">
        <div class="mdc-drawer__header">
            <h3 class="mdc-drawer__title">Capsule App</h3>
            <h6 class="mdc-drawer__subtitle">{{ app.user.firstName }} {{ app.user.lastName }}</h6>
        </div>
        <div class="mdc-drawer__content">
            <nav class="mdc-list">
                <a class="mdc-list-item mdc-list-item--activated" href="{{ path('dashboard') }}" aria-selected="true">
                    <i class="material-icons mdc-list-item__graphic" aria-hidden="true">home</i>
                    Home
                </a>
                <a class="mdc-list-item" href="#">
                    <i class="material-icons mdc-list-item__graphic" aria-hidden="true">settings</i>
                    Settings
                </a>
                <a class="mdc-list-item" href="#">
                    <i class="material-icons mdc-list-item__graphic" aria-hidden="true">help</i>
                    Help
                </a>
                <a href="{{ path('logout') }}" class="mdc-list-item">
                    <i class="material-icons mdc-list-item__graphic" aria-hidden="true">exit_to_app</i>
                    Logout
                </a>
            </nav>
        </div>
    </aside>
    <div class="mdc-drawer-scrim"></div>

    {# Main content #}
    <div class="mdc-drawer-app-content">
        <header class="mdc-top-app-bar app-bar" id="app-bar" data-mdc-auto-init="MDCTopAppBar">
            <div class="mdc-top-app-bar__row">
                <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-start">
                    <a href="#" class="demo-menu material-icons mdc-top-app-bar__navigation-icon">menu</a>
                    <span class="mdc-top-app-bar__title">Dashboard</span>
                </section>
                <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-end" role="toolbar">
                    <a href="#" class="material-icons mdc-top-app-bar__action-item" aria-label="Add a new time capsule" alt="Add a new time capsule">add</a>
                    <a href="#" class="material-icons mdc-top-app-bar__action-item" data-link-capsule aria-label="Join a time capsule" alt="Join a time capsule">link</a>
                </section>
            </div>
        </header>

        <main class="main-content" id="main-content">
            <div class="mdc-top-app-bar--fixed-adjust"></div>
            <div class="mdc-layout-grid">
                {% if capsules is not empty %}
                <div class="mdc-layout-grid__inner">
                    <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12">
                        <div class="mdc-chip-set" data-mdc-auto-init="MDCChips">
                            <div class="mdc-chip" tabindex="0" data-chips-capsule-order="date">
                                <i class="material-icons mdc-chip__icon mdc-chip__icon--leading">event</i>
                                <div class="mdc-chip__text">Date</div>
                            </div>
                            <div class="mdc-chip" tabindex="1" data-chips-capsule-order="name">
                                <i class="material-icons mdc-chip__icon mdc-chip__icon--leading">text_format</i>
                                <div class="mdc-chip__text">Name</div>
                            </div>
                            <div class="mdc-chip" tabindex="2" data-chips-capsule-order="favorite">
                                <i class="material-icons mdc-chip__icon mdc-chip__icon--leading">favorite</i>
                                <div class="mdc-chip__text">Likes</div>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
                <div class="mdc-layout-grid__inner">

                    {% for capsule in capsules %}
                        <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-4">
                            <div class="mdc-card dashboard-capsule-card">
                                <div class="mdc-card__primary-action mdc-ripple-upgraded dashboard-capsule-card-primary" data-mdc-auto-init="MDCButton" data-capsule-redirect="{{ capsule.id }}">
                                    <h3 class="mdc-typography--body1 mdc-typography">{{ capsule.title }}</h3>
                                    <p class="mdc-typography mdc-typography--caption">{{ capsule.description|length < 200 ? capsule.description: capsule.description|slice(0, 197) ~ '...' }}</p>
                                </div>
                                <div class="mdc-card__action-icons dashboard-capsule-card-action">
                                    <button class="mdc-icon-button mdc-card__action mdc-card__action--icon mdc-icon-toggle material-icons" role="button" aria-pressed="false"
                                            data-mdc-auto-init="MDCToggle"
                                            aria-label="Add to favorites" tabindex="0"
                                            data-toggle-on='{"label": "Remove from favorites", "content": "favorite"}'
                                            data-toggle-off='{"label": "Add to favorites", "content": "favorite_border"}'>
                                        favorite_border
                                    </button>
                                    <button class="material-icons mdc-icon-button mdc-card__action mdc-card__action--icon" title="More options">more_vert</button>
                                </div>
                            </div>
                        </div>
                    {% else %}
                        <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12">
                            <h3 class="mdc-typography--headline3 mdc-typography text-centered">You haven't any time capsule :(</h3>
                            <p class="mdc-typography mdc-typography--headline6 text-centered">You can create a new time capsule by clicking on + icon or contribute to an existing one by getting an invite link</p>
                        </div>
                    {% endfor %}

                </div>
            </div>
        </main>
    </div>

    {# Invite link modal dialog #}
    <aside id="link-dialog"
           class="mdc-dialog"
           role="alertdialog"
           aria-labelledby="my-mdc-dialog-label"
           aria-describedby="my-mdc-dialog-description"
            data-mdc-auto-init="MDCDialog">
        <div class="mdc-dialog__surface">
            <header class="mdc-dialog__header">
                <h2 id="my-mdc-dialog-label" class="mdc-dialog__header__title">
                    Join a time capsule
                </h2>
            </header>
            <section id="my-mdc-dialog-description" class="mdc-dialog__body">
                <div class="mdc-text-field mdc-text-field--fullwidth">
                    <input class="mdc-text-field__input"
                           type="text"
                           placeholder="Enter capsule url"
                           aria-label="Enter capsule url"
                            id="join-capsule-text-field">
                </div>
            </section>
            <footer class="mdc-dialog__footer">
                <button type="button" class="mdc-button mdc-dialog__footer__button mdc-dialog__footer__button--cancel">Decline</button>
                <button type="button" class="mdc-button mdc-dialog__footer__button mdc-dialog__footer__button--accept">Accept</button>
            </footer>
        </div>
        <div class="mdc-dialog__backdrop"></div>
    </aside>
{% endblock %}
